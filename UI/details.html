<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Order and Process Parcels" />
    <meta name="author" content="Sanni Michael Tomiwa" />
    <title>Send IT | Parcel Details</title>
    <link
      href="https://fonts.googleapis.com/css?family=Sunflower:300"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Maven+Pro|Ubuntu"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="assets/css/responsive.css" />
    <style></style>
  </head>
  <body>
    <header>
      <div class="container">
        <div id="branding">
          <h1>
            <a href="index.html">
              <span id="trackerText">Send<span id="highlighter">it</span></span>
            </a>
          </h1>
        </div>
        <nav>
          <ul>
            <li><a href="dashboard.html">Dashboard</a></li>
            <li><a class="current" href="parcel.html">Parcel</a></li>
            <li><a href="login.html"> Logout</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <div id="right-panel">
      <div id="inputs">
        <br />
        <div>
          <h1 style=" color:#f17a9e"><strong>Request Details</strong></h1>
        </div>
        <p style="padding-top:5px">
          <b>Request Date</b>: May 22, 2018. 5:00pm <br /><b>Weight</b>: 20kg<br /><b
            >Amount</b
          >: #2000 <br /><b>Status</b> : <span id="status">Pending</span> <br /><b>Start Point</b> :
          Hughes Ave, Alagomeji-Yaba, Lagos, Nigeria<br /><b>Destination</b>
          :235 Ikorodu Rd, Ilupeju, Lagos, Nigeria
        </p>
      </div>
      <br />
      <div>
        <h1 style=" color:#f17a9e"><strong>Results</strong></h1>
      </div>
      <div id="output" style="padding-top:5px"></div>
      <button class="button button2" id="myBtn">Cancel Order</button>
      <a href="user_change_destination.html"
        ><button class="button" id="approve">Change Destination</button></a
      >
    </div>
    <div id="map"></div>
    <br />
    <footer>
      <p style="padding-top:17px">
        <span id="trackerText">Send<span id="highlighter">it</span></span> ,
        Copyright &copy; 2018
      </p>
    </footer>
    <div id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
          <span class="close">&times;</span>
          <h2>Are you sure you want to cancel order ?</h2>
          <br>
          <button class="button yesBtn" id="approve">Yes</button>
          <button class="button button2 noBtn">No</button>
      </div>
    <script src="assets/js/app.js"></script>
    <script>
      const modal = document.getElementById("myModal");

      // Get the button that opens the modal
      const btn = document.getElementById("myBtn");

      // Get the <span> element that closes the modal
      const span = document.getElementsByClassName("close")[0];

      const spanBtn = document.getElementsByClassName("yesBtn")[0];

      const noBtn = document.getElementsByClassName("noBtn")[0];

      // When the user clicks the button, open the modal
      btn.onclick = function() {
        modal.style.display = "block";
      };

      // When the user clicks on <span> (x), close the modal
      span.onclick = function() {
        modal.style.display = "none";
      };

      spanBtn.onclick = function() {
        console.log('hi')
        document.getElementById('status').innerHTML = `<span style="color:red">Canceled</span>`
        modal.style.display = "none";
      };

      noBtn.onclick = function() {
        modal.style.display = "none";
      };

      // When the user clicks anywhere outside of the modal, close it
      window.onclick = function(event) {
        if (event.target == modal) {
          modal.style.display = "none";
        }
      };
      function initMap() {
        const bounds = new google.maps.LatLngBounds();
        const markersArray = [];

        const origin1 = { lat: 6.500197, lng: 3.378939 };
        const origin2 = "Hughes Ave, Alagomeji-Yaba, Lagos, Nigeria";
        const destinationA = "235 Ikorodu Rd, Ilupeju, Lagos, Nigeria";
        const destinationB = { lat: 6.553824, lng: 3.366473 };

        const destinationIcon =
          "https://chart.googleapis.com/chart?" +
          "chst=d_map_pin_letter&chld=D|FF0000|000000";
        const originIcon =
          "https://chart.googleapis.com/chart?" +
          "chst=d_map_pin_letter&chld=O|FFFF00|000000";
        const map = new google.maps.Map(document.getElementById("map"), {
          center: { lat: 55.53, lng: 9.4 },
          zoom: 10
        });
        const geocoder = new google.maps.Geocoder();

        const service = new google.maps.DistanceMatrixService();
        service.getDistanceMatrix(
          {
            origins: [origin1, origin2],
            destinations: [destinationA, destinationB],
            travelMode: "DRIVING",
            unitSystem: google.maps.UnitSystem.METRIC,
            avoidHighways: false,
            avoidTolls: false
          },
          function(response, status) {
            if (status !== "OK") {
              alert("Error was: " + status);
            } else {
              const originList = response.originAddresses;
              const destinationList = response.destinationAddresses;
              const outputDiv = document.getElementById("output");
              outputDiv.innerHTML = "";
              deleteMarkers(markersArray);

              const showGeocodedAddressOnMap = function(asDestination) {
                const icon = asDestination ? destinationIcon : originIcon;
                return function(results, status) {
                  if (status === "OK") {
                    map.fitBounds(bounds.extend(results[0].geometry.location));
                    markersArray.push(
                      new google.maps.Marker({
                        map: map,
                        position: results[0].geometry.location,
                        icon: icon
                      })
                    );
                  } else {
                    alert("Geocode was not successful due to: " + status);
                  }
                };
              };

              for (let i = 0; i < originList.length; i++) {
                const results = response.rows[i].elements;
                geocoder.geocode(
                  { address: originList[i] },
                  showGeocodedAddressOnMap(false)
                );
                for (let j = 0; j < results.length; j++) {
                  geocoder.geocode(
                    { address: destinationList[j] },
                    showGeocodedAddressOnMap(true)
                  );
                  outputDiv.innerHTML =
                    '<span style="font-size:15px"><b>Start Point</b> : ' +
                    originList[i] +
                    '</span> <br> <span style="font-size:15px"><b>End Point</b> : ' +
                    destinationList[j] +
                    '</span><br> <span style="font-size:15px"><b>Distance</b>  : ' +
                    results[j].distance.text +
                    ' </span> <br> <span style="font-size:15px"><b>Duration</b> : ' +
                    results[j].duration.text +
                    "</span></b>";
                }
              }
            }
          }
        );
      }

      function deleteMarkers(markersArray) {
        for (let i = 0; i < markersArray.length; i++) {
          markersArray[i].setMap(null);
        }
        markersArray = [];
      }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAdq3B2pNW6tzShvaVQ1TDmon1dBSw0KtY&callback=initMap"></script>
  </body>
</html>
